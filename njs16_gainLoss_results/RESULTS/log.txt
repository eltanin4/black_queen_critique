START OF LOG FILE
# Process_id= 3639
+=============================================================+
+  The gainLoss project:										
+  Analysis of Phyletic Patterns in a Likelihood Framework		
+  Version: gainLoss.VR01.266 - last updated 14.10.2013						
+  Ofir Cohen - ofircohe@tau.ac.il								
+=============================================================+

 ---------------------- THE PARAMETERS ----------------------------
Likelihood computation is performed while acounting for un-oberved data
With min number of presences('1's)= 1
With min number of absences('0's)= 0
'Reversible'(Root.freq==stationary.freq) model is used
RootFreq EQ stationary (taken from each sp - gain/(gain+loss) )
inTree file: /home/guest/work/black_queen_critique/njs16_tree.txt
inSeq file: /home/guest/work/black_queen_critique/njs16_msa_file.txt
log: kegg2013_MOtree_results_TEST//log.txt with level= 5
gain , loss ~ Gamma(Alpha,Beta) 
gain - a Gamma prior distribution with: 3 categories
loss - a Gamma prior distribution with: 3 categories
Optimization of the model parmeters is performed
branch lengths optimization is performed using 'BBL-EM'
rate4site is calculated 
gain and loss 4site are calculated 
calculePosteriorExpectationOfChange is done Analytically
-------------------------------------------------------------------

 startSequenceContainer
numberOfSeqs=31
seqLen=1684
Num of zeros=38260
Num of ones=13944
Num of unKnowns=0

 startStochasticProcessVec with: GainCategories=3 and GainCategories=3

InitGainLossByEmpiricalFreq: freq 1= 0.267106 Thus, gainLossRatioToCompleteByBeta= 0.182227
gainDist GENERAL_GAMMA with: initAlphaGain=1 initBetaGain=2.34258 and _numberOfGainCategories= 3
lossDist GENERAL_GAMMA with: initAlphaLoss=0.5 initBetaLoss=0.42688 and _numberOfLossCategories= 3
Stochastic process vector normalized with norm_factor=0.403486
startStochasticProcess SimpleGamma of 4 categories... 
with gain=0.42688 loss=1.17129 root(1)=0.267106
Stochastic process 'simple' normalized with norm_factor=0.625716

 startingEvolTreeTopology...
default rooting used, root name is N1
sons of root are:
N2  N16  
unObservableData object initialized with number of unObservable patterns= 1
The Tree Likelihood AllPosAlphTheSame is -18959.6
Starting normalizeQandTree...(so that sumQii=1 (or weighted ave. of sunOii's for many Qs))
Q were multiplied by 1
The Tree Likelihood AllPosAlphTheSame is -18959.6
AlphaGain 1
BetaGain 0.945196
  Gain Expectation = 1.05798
  Gain Expectancy = 1.05798
  Gain Standard Deviation = 1.05798
AlphaLoss 0.5
BetaLoss 0.17224
  Loss Expectation = 2.90292
  Loss Expectancy = 2.90292
  Loss Standard Deviation = 4.10535
	Expectancy(Gain)/Expectancy(Loss)  ratio by Gamma Params= 0.364454
	Expectancy(Gain)/Expectancy(Loss)  by computation = 0.364454
 Stationary '1' Freq at the root - for each stochastic process g/(g+l), with expectation of 0.412486
 Total branch lengths:38.74

Starting MaxParsimonyChange...
 MaxParsimony with costMatrix - gainLossRatio 1:2.001
Cost of tree is 7221.51 (with 5709 events)
 Gain=1511
 Losses=4198
TIME = 0.0166667 minutes



 *** Start Optimizations
 Start multipleAllBranchesByFactorAtStart use epsilonOptimization 0.02 Total branch lengths:38.74
Allow proportion: 1e-08 to 1e+08
Branch factor val = 1 logL = -18959.6
Branch factor val = 0.000879573 logL = -32974.9
Branch factor val = 1136.91 logL = -24445.4
Branch factor val = 4.65872 logL = -21022.9
Branch factor val = 0.0680481 logL = -18888.8
Branch factor val = 0.250044 logL = -18407.9
Branch factor val = 0.243207 logL = -18408
Branch factor val = 0.257072 logL = -18408.3
The Tree Likelihood AllPosAlphTheSame is -18407.9
Tree multiplied by 0.250044 Total branch lengths:9.6867
 *** Starting bbBLEMwithSimpleSpBeforeFullOptimization
*** BBL-EM.  Likelihood=-18407.9
 BBL-EM:  tollForPairwiseDist=0.01 and epsilonOptimizationBBLIter=1.84079
--- Iter=0 logL=-19113.3
--- Iter=1 logL=-18318.4
--- Iter=2 logL=-18225.4
--- Iter=3 logL=-18189.3
--- Iter=4 logL=-18169.9
--- Iter=5 logL=-18157.2
--- Iter=6 logL=-18148
--- Iter=7 logL=-18140.9
--- Iter=8 logL=-18135.2
--- Iter=9 logL=-18130.5
--- Iter=10 logL=-18126.5
--- Iter=11 logL=-18123.2
--- Iter=12 logL=-18120.5
--- Iter=13 logL=-18118.3
--- Iter=14 logL=-18116.5
--- Iter=15 logL=-18114.9
Overall running time for BBL = 11 sec
Likelihood after BBL-EM=-17614.1
 Total branch lengths:7.52132
-------------------------------
Starting optimizations: maxNumIterations=3

######### optimization starting epsilonCycle=1 maxNumIterations=3
start optimization with L= -17614.1

------ Model+BBL iter=1
### optimization starting- epsilonOptParam=0.01 epsilonOptIter= 0.03, MaxNumIterations=10
start optimization with:
 L= -17614.1
 gainLossRatio= 0.364454
 GainAlpha= 1 GainBeta= 0.945196
 LossAlpha= 0.5 LossBeta= 0.17224

---- iter=1
with val= 2.31448 which_param:: 9 L=-18791.3
with val= 0.289276 which_param:: 9 L=-17550.3
with val= 0.0800094 which_param:: 9 L=-17369.2
with val= 0.0904406 which_param:: 9 L=-17370.3
with val= 0.0820559 which_param:: 9 L=-17369.1
with val= 0.0841334 which_param:: 9 L=-17369.2
currBestL= -17369.1	GainLossRatio=0.0820559
with val= 1 which_param:: 0 L=-17369.1
with val= 8.25735 which_param:: 0 L=-17568.7
with val= 3.77206 which_param:: 0 L=-17500.5
with val= 2.05883 which_param:: 0 L=-17432.8
with val= 1.40444 which_param:: 0 L=-17393
with val= 0.656231 which_param:: 0 L=-17366.9
with val= 0.780965 which_param:: 0 L=-17363.4
with val= 0.806869 which_param:: 0 L=-17363.5
with val= 0.788774 which_param:: 0 L=-17363.4
with val= 0.773155 which_param:: 0 L=-17363.5
currBestL= -17363.4	GainAlpha=0.780965
with val= 0.5 which_param:: 3 L=-17363.4
with val= 7.94834 which_param:: 3 L=-20518.7
with val= 3.34501 which_param:: 3 L=-19393.6
with val= 1.5867 which_param:: 3 L=-18250.9
with val= 0.915082 which_param:: 3 L=-17560.4
with val= 0.241738 which_param:: 3 L=-18065.5
with val= 0.6575 which_param:: 3 L=-17356.4
with val= 0.589756 which_param:: 3 L=-17338.6
with val= 0.583858 which_param:: 3 L=-17338.3
with val= 0.577582 which_param:: 3 L=-17338.2
with val= 0.547948 which_param:: 3 L=-17341.7
with val= 0.571806 which_param:: 3 L=-17338.4
currBestL= -17338.2	LossAlpha=0.577582

---- iter=2
with val= 1.20797 which_param:: 9 L=-18027.6
with val= 0.193545 which_param:: 9 L=-17374.2
with val= 0.0624129 which_param:: 9 L=-17386.3
with val= 0.114727 which_param:: 9 L=-17321.9
with val= 0.11227 which_param:: 9 L=-17321.6
with val= 0.109219 which_param:: 9 L=-17321.5
with val= 0.0882005 which_param:: 9 L=-17330.9
with val= 0.106827 which_param:: 9 L=-17321.7
currBestL= -17321.5	GainLossRatio=0.109219
with val= 0.780965 which_param:: 0 L=-17321.5
with val= 8.12198 which_param:: 0 L=-17518.7
with val= 3.58498 which_param:: 0 L=-17446.9
with val= 1.852 which_param:: 0 L=-17374.1
with val= 1.19007 which_param:: 0 L=-17334.4
with val= 0.397266 which_param:: 0 L=-17378.8
with val= 0.937227 which_param:: 0 L=-17323
with val= 0.802264 which_param:: 0 L=-17321.3
with val= 0.825178 which_param:: 0 L=-17321.3
with val= 0.816927 which_param:: 0 L=-17321.3
with val= 0.83343 which_param:: 0 L=-17321.3
currBestL= -17321.3	GainAlpha=0.825178
with val= 0.577582 which_param:: 3 L=-17321.3
with val= 7.99628 which_param:: 3 L=-19476.2
with val= 3.41127 which_param:: 3 L=-18664.9
with val= 1.65996 which_param:: 3 L=-17885.3
with val= 0.991012 which_param:: 3 L=-17443.9
with val= 0.341983 which_param:: 3 L=-17687.4
with val= 0.732266 which_param:: 3 L=-17317.9
with val= 0.663708 which_param:: 3 L=-17307.2
with val= 0.657071 which_param:: 3 L=-17307
with val= 0.650501 which_param:: 3 L=-17307.1
currBestL= -17307	LossAlpha=0.657071

---- iter=3
with val= 1.28593 which_param:: 9 L=-18030.6
with val= 0.201173 which_param:: 9 L=-17328
with val= 0.0639219 which_param:: 9 L=-17437.9
with val= 0.153579 which_param:: 9 L=-17301
with val= 0.140568 which_param:: 9 L=-17297.7
with val= 0.131979 which_param:: 9 L=-17297.3
with val= 0.134679 which_param:: 9 L=-17297.3
with val= 0.137407 which_param:: 9 L=-17297.4
currBestL= -17297.3	GainLossRatio=0.134679
with val= 0.825178 which_param:: 0 L=-17297.3
with val= 8.14931 which_param:: 0 L=-17491.7
with val= 3.62275 which_param:: 0 L=-17420.3
with val= 1.89375 which_param:: 0 L=-17349
with val= 1.23334 which_param:: 0 L=-17310.4
with val= 0.367103 which_param:: 0 L=-17376.7
with val= 0.650209 which_param:: 0 L=-17305.4
with val= 0.909464 which_param:: 0 L=-17297.6
with val= 0.85634 which_param:: 0 L=-17297.2
with val= 0.847776 which_param:: 0 L=-17297.2
with val= 0.839298 which_param:: 0 L=-17297.2
currBestL= -17297.2	GainAlpha=0.847776
with val= 0.657071 which_param:: 3 L=-17297.2
with val= 8.04541 which_param:: 3 L=-18891.6
with val= 3.47917 which_param:: 3 L=-18270.1
with val= 1.73502 which_param:: 3 L=-17697.2
with val= 1.06881 which_param:: 3 L=-17387.2
with val= 0.385017 which_param:: 3 L=-17597.2
with val= 0.806357 which_param:: 3 L=-17298.4
with val= 0.726438 which_param:: 3 L=-17290.3
with val= 0.733702 which_param:: 3 L=-17290.4
with val= 0.719173 which_param:: 3 L=-17290.3
currBestL= -17290.3	LossAlpha=0.726438

---- iter=4
with val= 1.36358 which_param:: 9 L=-18044
with val= 0.208595 which_param:: 9 L=-17304
with val= 0.0653695 which_param:: 9 L=-17501.5
with val= 0.184612 which_param:: 9 L=-17292.5
with val= 0.163028 which_param:: 9 L=-17286.4
with val= 0.114991 which_param:: 9 L=-17307.6
with val= 0.151943 which_param:: 9 L=-17285.8
with val= 0.154833 which_param:: 9 L=-17285.8
with val= 0.157748 which_param:: 9 L=-17285.9
currBestL= -17285.8	GainLossRatio=0.154833
with val= 0.847776 which_param:: 0 L=-17285.8
with val= 8.16327 which_param:: 0 L=-17480.6
with val= 3.64205 which_param:: 0 L=-17408.5
with val= 1.91509 which_param:: 0 L=-17337.1
with val= 1.25545 which_param:: 0 L=-17299
with val= 0.373422 which_param:: 0 L=-17368
with val= 0.666589 which_param:: 0 L=-17293.8
with val= 0.927635 which_param:: 0 L=-17286.1
with val= 0.875167 which_param:: 0 L=-17285.7
with val= 0.866415 which_param:: 0 L=-17285.7
with val= 0.857751 which_param:: 0 L=-17285.7
currBestL= -17285.7	GainAlpha=0.866415
with val= 0.726438 which_param:: 3 L=-17285.7
with val= 8.08828 which_param:: 3 L=-18577.2
with val= 3.53841 which_param:: 3 L=-18063
with val= 1.80052 which_param:: 3 L=-17602.8
with val= 1.1367 which_param:: 3 L=-17360.9
with val= 0.388574 which_param:: 3 L=-17611
with val= 0.883143 which_param:: 3 L=-17292.2
with val= 0.767995 which_param:: 3 L=-17282.8
with val= 0.78351 which_param:: 3 L=-17282.7
with val= 0.791345 which_param:: 3 L=-17282.8
currBestL= -17282.7	LossAlpha=0.78351

---- iter=5
with val= 1.42834 which_param:: 9 L=-18062.1
with val= 0.214664 which_param:: 9 L=-17291.9
with val= 0.0665385 which_param:: 9 L=-17560.8
with val= 0.207868 which_param:: 9 L=-17289
with val= 0.179988 which_param:: 9 L=-17281.1
with val= 0.123075 which_param:: 9 L=-17308.3
with val= 0.168614 which_param:: 9 L=-17280.5
with val= 0.171642 which_param:: 9 L=-17280.4
with val= 0.174694 which_param:: 9 L=-17280.6
currBestL= -17280.4	GainLossRatio=0.171642
with val= 0.866415 which_param:: 0 L=-17280.4
with val= 8.17479 which_param:: 0 L=-17478.3
with val= 3.65797 which_param:: 0 L=-17404.9
with val= 1.93269 which_param:: 0 L=-17332.6
with val= 1.2737 which_param:: 0 L=-17294.2
with val= 0.343088 which_param:: 0 L=-17384.7
with val= 0.666522 which_param:: 0 L=-17289.4
with val= 0.940164 which_param:: 0 L=-17280.9
with val= 0.886557 which_param:: 0 L=-17280.4
with val= 0.895423 which_param:: 0 L=-17280.5
with val= 0.877692 which_param:: 0 L=-17280.4
currBestL= -17280.4	GainAlpha=0.877692
with val= 0.78351 which_param:: 3 L=-17280.4
with val= 8.12356 which_param:: 3 L=-18378.4
with val= 3.58716 which_param:: 3 L=-17934
with val= 1.85441 which_param:: 3 L=-17545.1
with val= 1.19256 which_param:: 3 L=-17345.1
with val= 0.399196 which_param:: 3 L=-17604.9
with val= 0.939752 which_param:: 3 L=-17288.1
with val= 0.804702 which_param:: 3 L=-17279.3
with val= 0.829268 which_param:: 3 L=-17279
with val= 0.820975 which_param:: 3 L=-17279
currBestL= -17279	LossAlpha=0.820975

---- iter=6
with val= 1.48471 which_param:: 9 L=-18083.4
with val= 0.219861 which_param:: 9 L=-17287
with val= 0.0675295 which_param:: 9 L=-17598.9
with val= 0.223217 which_param:: 9 L=-17288.3
with val= 0.190549 which_param:: 9 L=-17279
with val= 0.128211 which_param:: 9 L=-17309.9
with val= 0.179049 which_param:: 9 L=-17278.4
with val= 0.182155 which_param:: 9 L=-17278.3
with val= 0.185284 which_param:: 9 L=-17278.5
currBestL= -17278.3	GainLossRatio=0.182155
with val= 0.877692 which_param:: 0 L=-17278.3
with val= 8.18176 which_param:: 0 L=-17478.9
with val= 3.6676 which_param:: 0 L=-17404.3
with val= 1.94334 which_param:: 0 L=-17331.3
with val= 1.28473 which_param:: 0 L=-17292.5
with val= 0.58064 which_param:: 0 L=-17299.6
with val= 0.965884 which_param:: 0 L=-17279.2
with val= 0.858953 which_param:: 0 L=-17278.4
with val= 0.886609 which_param:: 0 L=-17278.3
with val= 0.868915 which_param:: 0 L=-17278.4
with val= 0.820975 which_param:: 3 L=-17278.3
with val= 8.14671 which_param:: 3 L=-18275.7
with val= 3.61916 which_param:: 3 L=-17868.5
with val= 1.88979 which_param:: 3 L=-17516.8
with val= 1.22922 which_param:: 3 L=-17338.1
with val= 0.394928 which_param:: 3 L=-17624.8
with val= 0.658239 which_param:: 3 L=-17315
with val= 0.912719 which_param:: 3 L=-17280
with val= 0.857627 which_param:: 3 L=-17277.6
with val= 0.849051 which_param:: 3 L=-17277.6
with val= 0.84056 which_param:: 3 L=-17277.7
currBestL= -17277.6	LossAlpha=0.849051

---- iter=7
with val= 1.52109 which_param:: 9 L=-18092.5
with val= 0.223175 which_param:: 9 L=-17284.2
with val= 0.0681568 which_param:: 9 L=-17628.7
with val= 0.232441 which_param:: 9 L=-17287.7
with val= 0.197912 which_param:: 9 L=-17278
with val= 0.131715 which_param:: 9 L=-17312
with val= 0.18663 which_param:: 9 L=-17277.4
with val= 0.189789 which_param:: 9 L=-17277.4
with val= 0.183523 which_param:: 9 L=-17277.5
currBestL= -17277.4	GainLossRatio=0.18663
with val= 0.877692 which_param:: 0 L=-17277.4
with val= 8.18176 which_param:: 0 L=-17477.7
with val= 3.6676 which_param:: 0 L=-17402.9
with val= 1.94334 which_param:: 0 L=-17329.9
with val= 1.28473 which_param:: 0 L=-17291.2
with val= 0.345666 which_param:: 0 L=-17383.5
with val= 0.674476 which_param:: 0 L=-17286.3
with val= 0.948216 which_param:: 0 L=-17277.8
with val= 0.894988 which_param:: 0 L=-17277.4
with val= 0.868915 which_param:: 0 L=-17277.4
currBestL= -17277.4	GainAlpha=0.877692
with val= 0.849051 which_param:: 3 L=-17277.4
with val= 8.16406 which_param:: 3 L=-18236.5
with val= 3.64314 which_param:: 3 L=-17845
with val= 1.9163 which_param:: 3 L=-17509
with val= 1.2567 which_param:: 3 L=-17338.4
with val= 0.320232 which_param:: 3 L=-17826.6
with val= 0.64706 which_param:: 3 L=-17323.3
with val= 0.931932 which_param:: 3 L=-17280
with val= 0.87321 which_param:: 3 L=-17277.3
with val= 0.881942 which_param:: 3 L=-17277.4
with val= 0.864477 which_param:: 3 L=-17277.2
currBestL= -17277.2	LossAlpha=0.864477

---- iter=8
with val= 1.53684 which_param:: 9 L=-18095.5
with val= 0.224601 which_param:: 9 L=-17282.8
with val= 0.0684256 which_param:: 9 L=-17646
with val= 0.238162 which_param:: 9 L=-17287.8
with val= 0.201888 which_param:: 9 L=-17277.6
with val= 0.133545 which_param:: 9 L=-17313.4
with val= 0.190658 which_param:: 9 L=-17277
with val= 0.193844 which_param:: 9 L=-17277
with val= 0.187524 which_param:: 9 L=-17277.2
currBestL= -17277	GainLossRatio=0.190658
with val= 0.877692 which_param:: 0 L=-17277
with val= 8.18176 which_param:: 0 L=-17478.6
with val= 3.6676 which_param:: 0 L=-17403.2
with val= 1.94334 which_param:: 0 L=-17329.7
with val= 1.28473 which_param:: 0 L=-17290.8
with val= 0.357279 which_param:: 0 L=-17376.4
with val= 0.678912 which_param:: 0 L=-17285.7
with val= 0.948559 which_param:: 0 L=-17277.5
with val= 0.895739 which_param:: 0 L=-17277
with val= 0.904697 which_param:: 0 L=-17277
with val= 0.886782 which_param:: 0 L=-17277
currBestL= -17277	GainAlpha=0.895739
with val= 0.864477 which_param:: 3 L=-17277
with val= 8.1736 which_param:: 3 L=-18203.6
with val= 3.65631 which_param:: 3 L=-17823.9
with val= 1.93086 which_param:: 3 L=-17499.9
with val= 1.2718 which_param:: 3 L=-17336.1
with val= 0.572473 which_param:: 3 L=-17377
with val= 0.964053 which_param:: 3 L=-17281.3
with val= 0.849675 which_param:: 3 L=-17277.4
with val= 0.87839 which_param:: 3 L=-17276.9
with val= 0.887174 which_param:: 3 L=-17277
currBestL= -17276.9	LossAlpha=0.87839

---- iter=9
with val= 1.55116 which_param:: 9 L=-18109.6
with val= 0.225892 which_param:: 9 L=-17281.9
with val= 0.0686684 which_param:: 9 L=-17662.2
with val= 0.2421 which_param:: 9 L=-17287.7
with val= 0.205079 which_param:: 9 L=-17277.4
with val= 0.135028 which_param:: 9 L=-17314.9
with val= 0.194076 which_param:: 9 L=-17276.8
with val= 0.197284 which_param:: 9 L=-17276.8
with val= 0.19092 which_param:: 9 L=-17276.9
currBestL= -17276.8	GainLossRatio=0.194076
with val= 0.895739 which_param:: 0 L=-17276.8
with val= 8.19292 which_param:: 0 L=-17479.5
with val= 3.68301 which_param:: 0 L=-17404
with val= 1.96038 which_param:: 0 L=-17330.6
with val= 1.3024 which_param:: 0 L=-17291.6
with val= 0.591794 which_param:: 0 L=-17297
with val= 0.973341 which_param:: 0 L=-17277.7
with val= 0.857937 which_param:: 0 L=-17277
with val= 0.886782 which_param:: 0 L=-17276.8
with val= 0.904697 which_param:: 0 L=-17276.8
currBestL= -17276.8	GainAlpha=0.895739
with val= 0.87839 which_param:: 3 L=-17276.8
with val= 8.18219 which_param:: 3 L=-18176.4
with val= 3.6682 which_param:: 3 L=-17807
with val= 1.944 which_param:: 3 L=-17492.9
with val= 1.28542 which_param:: 3 L=-17334.7
with val= 0.581072 which_param:: 3 L=-17372.8
with val= 0.974159 which_param:: 3 L=-17281
with val= 0.856264 which_param:: 3 L=-17277.3
with val= 0.887339 which_param:: 3 L=-17276.8
with val= 0.896212 which_param:: 3 L=-17276.8
currBestL= -17276.8	LossAlpha=0.887339

---- iter=10
with val= 1.56342 which_param:: 9 L=-18113.3
with val= 0.226994 which_param:: 9 L=-17281.4
with val= 0.0688752 which_param:: 9 L=-17671.6
with val= 0.245246 which_param:: 9 L=-17287.9
with val= 0.207314 which_param:: 9 L=-17277.3
with val= 0.136092 which_param:: 9 L=-17315.8
with val= 0.196313 which_param:: 9 L=-17276.7
with val= 0.199535 which_param:: 9 L=-17276.7
with val= 0.193143 which_param:: 9 L=-17276.8
currBestL= -17276.7	GainLossRatio=0.196313
with val= 0.895739 which_param:: 0 L=-17276.7
with val= 8.19292 which_param:: 0 L=-17480.1
with val= 3.68301 which_param:: 0 L=-17404.3
with val= 1.96038 which_param:: 0 L=-17330.6
with val= 1.3024 which_param:: 0 L=-17291.5
with val= 0.591794 which_param:: 0 L=-17297
with val= 0.973857 which_param:: 0 L=-17277.6
with val= 0.859417 which_param:: 0 L=-17276.8
with val= 0.886782 which_param:: 0 L=-17276.7
with val= 0.904697 which_param:: 0 L=-17276.7
with val= 0.887339 which_param:: 3 L=-17276.7
with val= 8.18773 which_param:: 3 L=-18159.4
with val= 3.67584 which_param:: 3 L=-17796.3
with val= 1.95245 which_param:: 3 L=-17488.6
with val= 1.29418 which_param:: 3 L=-17333.9
with val= 0.586602 which_param:: 3 L=-17370.3
with val= 0.980692 which_param:: 3 L=-17280.9
with val= 0.860417 which_param:: 3 L=-17277.3
with val= 0.896212 which_param:: 3 L=-17276.7
with val= 0.878465 which_param:: 3 L=-17276.8
 Too many iterations in optimizeGainLossModelVV. Iter= 11 Last optimized parameters are used.
-------------------------------
Model optimization over with: 
AlphaGain 0.895739
BetaGain 2.26763
 Gain Expectation = 0.779805
 Gain Expectancy = 0.395012
 Gain Standard Deviation = 0.417368
AlphaLoss 0.887339
BetaLoss 0.440989
 Loss Expectation = 3.97226
 Loss Expectancy = 2.01215
 Loss Standard Deviation = 2.13607
	Gain/Loss Expectancy ratio= 0.196313
	Expectancy(Gain)/Expectancy(Loss)  by computation = 0.196313
updated likelihood (after optimizeParameters)= -17276.7
Model optimization RUNNING TIME = 7.5 minutes

startStochasticProcess SimpleGamma of 4 categories... 
with gain=0.395012 loss=2.01215 root(1)=0.164098
*** _spSimple BBL-EM Optimization with Likelihood=	-17276.7
 BBL-EM:  tollForPairwiseDist=0.01 and epsilonOptimizationBBLIter=0.024
--- Iter=0 logL=-18400.6
--- Iter=1 logL=-18294
--- Iter=2 logL=-18260
--- Iter=3 logL=-18245.6
--- Iter=4 logL=-18237.6
--- Iter=5 logL=-18232.4
--- Iter=6 logL=-18228.8
--- Iter=7 logL=-18226.2
--- Iter=8 logL=-18224.3
--- Iter=9 logL=-18222.7
--- Iter=10 logL=-18221.6
--- Iter=11 logL=-18220.6
--- Iter=12 logL=-18219.8
--- Iter=13 logL=-18219.2
--- Iter=14 logL=-18218.8
--- Iter=15 logL=-18218.4
--- Iter=16 logL=-18218.1
--- Iter=17 logL=-18217.8
--- Iter=18 logL=-18217.5
--- Iter=19 logL=-18217.3
--- Iter=20 logL=-18217.1
--- Iter=21 logL=-18216.9
--- Iter=22 logL=-18216.8
--- Iter=23 logL=-18216.7
--- Iter=24 logL=-18216.6
--- Iter=25 logL=-18216.5
--- Iter=26 logL=-18216.5
--- Iter=27 logL=-18216.4
--- Iter=28 logL=-18216.3
--- Iter=29 logL=-18216.3
--- Iter=30 logL=-18216.2
--- Iter=31 logL=-18216.2
--- Iter=32 logL=-18216.1
--- Iter=33 logL=-18216
--- Iter=34 logL=-18216
--- Iter=35 logL=-18216
--- Iter=36 logL=-18215.9
--- Iter=37 logL=-18215.9
--- Iter=38 logL=-18215.9
--- Iter=39 logL=-18215.8
Overall running time for BBL = 27 sec
 Total branch lengths:9.64289
*** After Branch Lengths Opt. returned Likelihood=	-17524.3
NOTE: No improvment-> Retain previous tree
 Total branch lengths:7.52132
Branch Lengths RUNNING TIME = 0.583333 minutes

 !!! Warning !!!: after BBL likelihood did not improve-17276.7 -17276.7
 OverAll optimization converged. Iter= 1 Likelihood=-17276.7
Optimization RUNNING TIME = 8.11667 minutes

# Best likelihood after optimization=-17276.7
TIME = 8.53333 minutes

Starting normalizeQandTree...(so that sumQii=1 (or weighted ave. of sunOii's for many Qs))
Q were multiplied by 1
Tree branches multi by 1
The Tree Likelihood AllPosAlphTheSame is -17276.7
AlphaGain 0.895739
BetaGain 1.14867
  Gain Expectation = 0.779805
  Gain Expectancy = 0.779805
  Gain Standard Deviation = 0.823939
AlphaLoss 0.887339
BetaLoss 0.223384
  Loss Expectation = 3.97226
  Loss Expectancy = 3.97226
  Loss Standard Deviation = 4.21689
	Expectancy(Gain)/Expectancy(Loss)  ratio by Gamma Params= 0.196313
	Expectancy(Gain)/Expectancy(Loss)  by computation = 0.196313
 Stationary '1' Freq at the root - for each stochastic process g/(g+l), with expectation of 0.241083
 Total branch lengths:7.52132

 WARN: distanceFromRootForRecent=1, distanceFromNearestOTUForRecent=0.000001 are not estimated
Starting printLofPos...

Starting gain4site and loss4site...
perform computeGain4Site... while computing posteriorProb PerCategory PerPosition
Calculating posterior and expectation of posterior values for all sites
perform computeLoss4Site... while computing posteriorProb PerCategory PerPosition
Calculating posterior and expectation of posterior values for all sites
computeEB_EXP_GL4Site RUNNING TIME = 0.1 minutes

Starting calculePosteriorExpectationOfChange...

Computation stochastic mapping
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.128477
 Loss= 0.646362
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.128477
 Loss= 2.70199
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.128477
 Loss= 8.56842
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.532472
 Loss= 0.646362
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.532472
 Loss= 2.70199
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 0.532472
 Loss= 8.56842
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 1.67847
 Loss= 0.646362
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 1.67847
 Loss= 2.70199
computePosteriorOfChangeGivenTerminalsPerSpPerCat with sp:
 Gain= 1.67847
 Loss= 8.56842
TIME = 0.2 minutes

Mean   values Gain=3.85155	Loss=3.7381
Median values Gain=3.01097	Loss=2.88341

TIME = 0.216667 minutes (calculePosteriorExpectationOfChange)


Starting ancestralReconstructorBasedOnJoint...
computeAncestralPosterior (take into acount joint probabilty)...
TIME = 0 minutes


Starting computeBranchLegthDiffFactor...
 Likelihood reference (computed after BBL)=-17276.7
WARN... logL with  estimated BL=-17276.7 is lower than original BL=-17273.4
WARN... logL with  estimated BL=-17276.7 is lower than original BL=-17274.2
WARN... logL with  estimated BL=-17276.7 is lower than original BL=-17258.3
WARN... logL with  estimated BL=-17276.7 is lower than original BL=-17273.8
WARN... logL with  estimated BL=-17276.7 is lower than original BL=-17270.5

TOTAL RUNNING TIME = 10.4 minutes
